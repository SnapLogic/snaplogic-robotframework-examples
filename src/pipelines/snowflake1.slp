{"class_fqid":"com-snaplogic-pipeline_9","snode_id":"68e4b84aad6450a06b86ee15","instance_id":"2d11e8ec-98d9-44d2-94a6-38514012b1d9","instance_version":4,"link_map":{"link236":{"dst_id":"4113f1ae-38b0-473b-bfe4-f2f5a402d5f6","dst_view_id":"input0","src_id":"639de9bd-e295-4df4-86a3-4a53d8c5a37b","src_view_id":"output0","isGoto":false},"link240":{"dst_id":"5f73ca66-d56d-4806-98d0-b083b3c4bc5a","dst_view_id":"inputRows","src_id":"3b0d4b6e-37a0-4112-a7e9-8b4d667352d4","src_view_id":"output0","isGoto":false},"link241":{"dst_id":"3b0d4b6e-37a0-4112-a7e9-8b4d667352d4","dst_view_id":"input0","src_id":"4113f1ae-38b0-473b-bfe4-f2f5a402d5f6","src_view_id":"output0","isGoto":false},"link243":{"dst_id":"85339fdd-cbdd-4c77-aa90-96d923768a4b","dst_view_id":"input0","src_id":"3642f7c5-48d0-46d5-80ca-902ec518552f","src_view_id":"output0","isGoto":false},"link244":{"dst_id":"639de9bd-e295-4df4-86a3-4a53d8c5a37b","dst_view_id":"input0","src_id":"85339fdd-cbdd-4c77-aa90-96d923768a4b","src_view_id":"output0","isGoto":false}},"link_serial":251,"property_map":{"info":{"label":{"value":"snowflake_20251007065035853459"},"author":{"value":"spothana@snaplogic.com"},"pipeline_doc_uri":{"value":null},"notes":{"value":null},"purpose":{"value":null}},"error":{"error_behavior":{"value":"none"}},"settings":{"error_pipeline":{"value":null,"expression":false},"error_param_table":{"value":[]},"param_table":{"value":[{"capture":{"value":false},"key":{"value":"snowflake_acct"},"value":{"value":"../shared/swapna2_snowflake_account"},"required":{"value":false},"data_type":{"value":"string"},"description":{"value":null}},{"capture":{"value":false},"key":{"value":"schema_name"},"value":{"value":"DEMO"},"required":{"value":false},"data_type":{"value":"string"},"description":{"value":null}},{"capture":{"value":false},"key":{"value":"table_name"},"value":{"value":"DEMO.LIFEEVENTSDATA"},"required":{"value":false},"data_type":{"value":"string"},"description":{"value":null}},{"capture":{"value":false},"key":{"value":"expression_library"},"value":{"value":"../shared/snowflake_library.expr"},"required":{"value":false},"data_type":{"value":"string"},"description":{"value":null}}]},"imports":{"value":[{"path":{"value":"../shared/snowflake_library.expr","expression":false},"as":{"value":"expr"}}]},"cache_pipelines":{"value":[]}},"input":{},"output":{"5f73ca66-d56d-4806-98d0-b083b3c4bc5a_output101":{"label":{"value":"Snowflake - Insert - output0"},"view_type":{"value":"document"}}}},"render_map":{"scale_ratio":1,"pan_x_num":0,"pan_y_num":0,"default_snaplex":"66bb18b3aa46b2a308dd4148","detail_map":{"5f73ca66-d56d-4806-98d0-b083b3c4bc5a":{"grid_x_int":6,"grid_y_int":3,"rot_int":0,"recommendation_id":"8f6623d5-247e-3702-14e1-443f5983280c_0","source":"iris placeholder","index":0,"rot_tail_int":0,"input":{},"output":{},"error":{}},"85339fdd-cbdd-4c77-aa90-96d923768a4b":{"grid_x_int":2,"grid_y_int":3,"rot_int":0,"recommendation_id":null,"source":"","index":null,"rot_tail_int":0,"input":{},"output":{},"error":{}},"639de9bd-e295-4df4-86a3-4a53d8c5a37b":{"grid_x_int":3,"grid_y_int":3,"rot_int":0,"recommendation_id":null,"source":"snap catagory","index":null,"rot_tail_int":0,"input":{},"output":{},"error":{}},"4113f1ae-38b0-473b-bfe4-f2f5a402d5f6":{"grid_x_int":4,"grid_y_int":3,"rot_int":0,"recommendation_id":null,"source":"snap catagory","index":null,"rot_tail_int":0,"input":{},"output":{},"error":{}},"3b0d4b6e-37a0-4112-a7e9-8b4d667352d4":{"grid_x_int":5,"grid_y_int":3,"rot_int":0,"recommendation_id":null,"source":"","index":null,"rot_tail_int":0,"input":{},"output":{},"error":{}},"3642f7c5-48d0-46d5-80ca-902ec518552f":{"grid_x_int":1,"grid_y_int":3,"rot_int":0,"recommendation_id":null,"source":"","index":null,"rot_tail_int":0,"input":{},"output":{},"error":{}}},"snapgpt_extra":{"no_wizard":{"value":true}}},"snap_map":{"5f73ca66-d56d-4806-98d0-b083b3c4bc5a":{"class_fqid":"com-snaplogic-snaps-snowflake-insert_1-main31019","class_id":"com-snaplogic-snaps-snowflake-insert","class_version":1,"instance_fqid":"5f73ca66-d56d-4806-98d0-b083b3c4bc5a_1","instance_id":"5f73ca66-d56d-4806-98d0-b083b3c4bc5a","instance_version":1,"property_map":{"info":{"label":{"value":"Snowflake - Insert"},"notes":{}},"input":{"inputRows":{"view_type":{"value":"document"},"label":{"value":"rows"}}},"output":{"output101":{"label":{"value":"output0"},"view_type":{"value":"document"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"icebergTableProps":{"value":{"externalVolume":{"value":null,"expression":false},"baseLocation":{"value":null,"expression":false}}},"maxRetryProp":{"value":0,"expression":false},"execution_mode":{"value":"Validate & Execute"},"schemaName":{"value":"_schema_name","expression":true},"retryIntervalProp":{"value":1,"expression":false},"createTable":{"value":true},"isIcebergTable":{"value":false},"preserveCaseSensistiveness":{"value":false},"tableName":{"value":"_table_name","expression":true},"executable_during_suggest":{"value":false},"sqlQueryManagement":{"value":"Continue to execute queued queries when pipeline is stopped or if it fails"}},"account":{"account_ref":{"value":"_snowflake_acct","expression":true}},"view_serial":101},"class_build_tag":"main31019"},"85339fdd-cbdd-4c77-aa90-96d923768a4b":{"class_fqid":"com-snaplogic-snaps-transform-datatransform_4-main31019","class_id":"com-snaplogic-snaps-transform-datatransform","class_version":4,"instance_fqid":"85339fdd-cbdd-4c77-aa90-96d923768a4b_1","instance_id":"85339fdd-cbdd-4c77-aa90-96d923768a4b","instance_version":1,"property_map":{"info":{"label":{"value":"Extract fields "},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"execution_mode":{"value":"Validate & Execute"},"passThrough":{"value":false},"transformations":{"value":{"mappingRoot":{"value":"$"},"mappingTable":{"value":[{"expression":{"value":"$body.tax.filings","expression":true},"targetPath":{"value":"taxFiling"}},{"expression":{"value":"$body.demoIncometaxTaxfilingFilingUs.filing","expression":true},"targetPath":{"value":"filing"}},{"expression":{"value":"$body.demoIncometaxTaxdatamanagementTaxprofile.income","expression":true},"targetPath":{"value":"income"}},{"expression":{"value":"$body.insights.ttoLifeEventsArray","expression":true},"targetPath":{"value":"qualifiedEitc"}},{"expression":{"value":"$body.demoIncometaxTaxdatamanagementTaxprofile.lifeEvent","expression":true},"targetPath":{"value":"lifeEvent"}},{"expression":{"value":"$body.demoCustomergrowthandengagementCommerceOrdermanagementOmDerivedRealtimeCg.cgOrderDerived","expression":true},"targetPath":{"value":"orderSku"}},{"expression":{"value":"$body.demoAnalyticsAnalyticsreportingCustomerincomegroupstartmodelCustomerincomegroupstartmodel.startStrategicSegments","expression":true},"targetPath":{"value":"SegmentGenz"}},{"expression":{"value":"$body.demoFoundationIdentityandcustomer360Authentication.digitalIdentity.pseudonymId","expression":true},"targetPath":{"value":"$pseudonymId"}},{"expression":{"value":"$body.insights.marketing.taxPrep.firstAuthTimestampRT","expression":true},"targetPath":{"value":"$firstAuth_ts"}}]}}},"nullSafeAccess":{"value":true}},"view_serial":100},"class_build_tag":"main31019"},"639de9bd-e295-4df4-86a3-4a53d8c5a37b":{"class_fqid":"com-snaplogic-snaps-flow-datavalidator_1-main31019","class_id":"com-snaplogic-snaps-flow-datavalidator","class_version":1,"instance_fqid":"639de9bd-e295-4df4-86a3-4a53d8c5a37b_1","instance_id":"639de9bd-e295-4df4-86a3-4a53d8c5a37b","instance_version":1,"property_map":{"info":{"label":{"value":"Data Validator"},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"execution_mode":{"value":"Validate & Execute"},"constraintMappings":{"value":[{"sourcePath":{"value":"jsonPath($, \"firstAuth_ts[*].taxYear\")[0]"},"constraint":{"value":"Type"},"constraintValue":{"value":"string"}},{"sourcePath":{"value":"jsonPath($, \"taxFiling[*].errorCodes\")"},"constraint":{"value":"Type"},"constraintValue":{"value":"array"}},{"sourcePath":{"value":"$pseudonymId"},"constraint":{"value":"Required"},"constraintValue":{"value":"true"}},{"sourcePath":{"value":"$income.annualIncome"},"constraint":{"value":"Required"},"constraintValue":{"value":"true"}},{"sourcePath":{"value":"$pseudonymId"},"constraint":{"value":"MinLength"},"constraintValue":{"value":"5"}}]},"validateJsonPath":{"value":false},"standardizeErrorOutput":{"value":false}},"view_serial":100},"class_build_tag":"main31019"},"4113f1ae-38b0-473b-bfe4-f2f5a402d5f6":{"class_fqid":"com-snaplogic-snaps-flow-filter_2-main31019","class_id":"com-snaplogic-snaps-flow-filter","class_version":2,"instance_fqid":"4113f1ae-38b0-473b-bfe4-f2f5a402d5f6_1","instance_id":"4113f1ae-38b0-473b-bfe4-f2f5a402d5f6","instance_version":1,"property_map":{"info":{"label":{"value":"Filter"},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"execution_mode":{"value":"Validate & Execute"},"filterExpression":{"expression":true,"value":"Date.parse(parseFloat($firstAuth_ts[0].firstAuthTimestampRT)) < Date.now()"},"nullSafeAccess":{"value":false}},"view_serial":100},"class_build_tag":"main31019"},"3b0d4b6e-37a0-4112-a7e9-8b4d667352d4":{"class_fqid":"com-snaplogic-snaps-transform-datatransform_4-main31019","class_id":"com-snaplogic-snaps-transform-datatransform","class_version":4,"instance_fqid":"3b0d4b6e-37a0-4112-a7e9-8b4d667352d4_1","instance_id":"3b0d4b6e-37a0-4112-a7e9-8b4d667352d4","instance_version":1,"property_map":{"info":{"label":{"value":"Enrichment & Map"},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"execution_mode":{"value":"Validate & Execute"},"passThrough":{"value":false},"transformations":{"value":{"mappingRoot":{"value":"$"},"mappingTable":{"value":[{"expression":{"value":"lib.expr.irsFundAmount($filing)","expression":true},"targetPath":{"value":"$TY2024_TAXFILING_REFUNDBALDUEAMOUNT_FED"}},{"expression":{"value":"lib.expr.rejectedState($taxFiling)","expression":true},"targetPath":{"value":"$TY2024_TAXFILING_EFILESTATUS_STATEREJECTED"}},{"expression":{"value":"lib.expr.anaualIncome($income)","expression":true},"targetPath":{"value":"$TY2024_TTOGTKM_TOTALREVENUE"}},{"expression":{"value":"lib.expr.qual_eitc($qualifiedEitc)","expression":true},"targetPath":{"value":"$TY2024_TTOLIFEEVENTSARRAY_QUALIFIEDFOREITC"}},{"expression":{"value":"lib.expr.marital2024($lifeEvent)","expression":true},"targetPath":{"value":"$TY2024_TTOGTKM_HASGOTMARRIED"}},{"expression":{"value":"lib.expr.sku2024($orderSku)","expression":true},"targetPath":{"value":"$TY2024_COMMERCE_COMPLETEDSKU"}},{"expression":{"value":"lib.expr.genzFlag($SegmentGenz)","expression":true},"targetPath":{"value":"$TY2024_STRATEGICSEGMENTSTART_GENZ"}},{"expression":{"value":"$pseudonymId.toUpperCase()","expression":true},"targetPath":{"value":"$DCEVENTHEADERS_USERID"}},{"expression":{"value":"lib.expr.epoch($firstAuth_ts)","expression":true},"targetPath":{"value":"$TY2024_MARKETING_FIRSTAUTHTIMESTAMP"}}]}}},"nullSafeAccess":{"value":false}},"view_serial":100},"class_build_tag":"main31019"},"3642f7c5-48d0-46d5-80ca-902ec518552f":{"class_fqid":"com-snaplogic-snaps-transform-jsongenerator_2-UNKNOWN","class_id":"com-snaplogic-snaps-transform-jsongenerator","class_version":2,"instance_fqid":"3642f7c5-48d0-46d5-80ca-902ec518552f_1","instance_id":"3642f7c5-48d0-46d5-80ca-902ec518552f","instance_version":1,"property_map":{"account":{"account_ref":{"value":{}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"label":{"value":"output0"},"view_type":{"value":"document"}}},"input":{},"info":{"notes":{"value":""},"label":{"value":"CDC Data Generator"}},"settings":{"editable_content":{"value":"[\n  {\n    \"body\": {\n      \"id\": \"event-id-123\",\n      \"demoFoundationIdentityandcustomer360Authentication\": {\n        \"digitalIdentity\": {\n          \"pseudonymId\": \"13306e58e2f0fe44c3991f03e8027ff5a30\"\n        }\n      },\n      \"insights\": {\n        \"ttoLifeEventsArray\": [\n          {\n            \"taxYear\": 2024,\n            \"qualifiedForEitc\": true\n          }\n        ],\n        \"marketing\": {\n          \"taxPrep\": {\n            \"firstAuthTimestampRT\": [\n              {\n                \"taxYear\": 2024,\n                \"firstAuthTimestampRT\": \"1664492404235\"\n              }\n            ]\n          }\n        }\n      },\n      \"demoIncometaxTaxdatamanagementTaxprofile\": {\n        \"lifeEvent\": [\n          {\n            \"taxPeriodValue\": \"2024\",\n            \"hasMaritalStatusChanged\": true\n          }\n        ],\n        \"income\": {\n          \"taxPeriodValue\": \"2024\",\n          \"annualIncome\": \"40000\"\n        }\n      },\n      \"demoCustomergrowthandengagementCommerceOrdermanagementOmDerivedRealtimeCg\": {\n        \"cgOrderDerived\": [\n          {\n            \"taxYear\": \"2024\",\n            \"completedSku\": \"DELUXE\"\n          }\n        ]\n      },\n      \"demoAnalyticsAnalyticsreportingCustomerincomegroupstartmodelCustomerincomegroupstartmodel\": {\n        \"startStrategicSegments\": [\n          {\n            \"taxYear\": 2024,\n            \"segmentGenzFlag\": 0\n          }\n        ]\n      },\n      \"demoIncometaxTaxfilingFilingUs\": {\n        \"filing\": [\n          {\n            \"filingType\": \"IRS-IIT-FILING\",\n            \"taxYear\": \"2024\",\n            \"paymentAmount\": \"-500.0\",\n            \"filingStatusDate\": \"2025-02-07T14:15:09.959-08:00\"\n          }\n        ]\n      },\n      \"tax\": {\n        \"filings\": [\n          {\n            \"taxAgency\": \"CA\",\n            \"taxYear\": 2024,\n            \"status\": \"REJECTED_AGENCY\",\n            \"errorCodes\": [\n              \"679\"\n            ]\n          }\n        ]\n      }\n    }\n  },\n  {\n    \"body\": {\n      \"id\": \"event-id-001\",\n      \"demoFoundationIdentityandcustomer360Authentication\": {\n        \"digitalIdentity\": {\n          \"pseudonymId\": \"12345abcd\"\n        }\n      },\n      \"insights\": {\n        \"ttoLifeEventsArray\": [\n          {\n            \"taxYear\": 2024,\n            \"qualifiedForEitc\": true\n          }\n        ],\n        \"marketing\": {\n          \"taxPrep\": {\n            \"firstAuthTimestampRT\": [\n              {\n                \"taxYear\": 2024,\n                \"firstAuthTimestampRT\": \"1664492404235\"\n              }\n            ]\n          }\n        }\n      },\n      \"demoIncometaxTaxdatamanagementTaxprofile\": {\n        \"lifeEvent\": [\n          {\n            \"taxPeriodValue\": \"2024\",\n            \"hasMaritalStatusChanged\": true\n          }\n        ],\n        \"income\": {\n          \"taxPeriodValue\": \"2024\",\n          \"annualIncome\": \"50000\"\n        }\n      },\n      \"demoCustomergrowthandengagementCommerceOrdermanagementOmDerivedRealtimeCg\": {\n        \"cgOrderDerived\": [\n          {\n            \"taxYear\": 2024,\n            \"completedSku\": \"DELUXE\"\n          }\n        ]\n      },\n      \"demoAnalyticsAnalyticsreportingCustomerincomegroupstartmodelCustomerincomegroupstartmodel\": {\n        \"startStrategicSegments\": [\n          {\n            \"taxYear\": 2024,\n            \"segmentGenzFlag\": 0\n          }\n        ]\n      },\n      \"demoIncometaxTaxfilingFilingUs\": {\n        \"filing\": [\n          {\n            \"filingType\": \"IRS-IIT-FILING\",\n            \"taxYear\": 2024,\n            \"paymentAmount\": \"-500.0\",\n            \"filingStatusDate\": \"2025-02-07T14:15:09.959-08:00\"\n          }\n        ]\n      },\n      \"tax\": {\n        \"filings\": [\n          {\n            \"taxAgency\": \"CA\",\n            \"taxYear\": 2024,\n            \"status\": \"REJECTED_AGENCY\",\n            \"errorCodes\": [\n              \"679\"\n            ]\n          }\n        ]\n      }\n    }\n  }\n\n\n]"},"arrayElementsAsDocuments":{"value":true},"execution_mode":{"value":"Validate & Execute"},"passThroughProp":{"value":false},"supportTypeExts":{"value":false}},"view_serial":null},"class_build_tag":"UNKNOWN"}},"path_id":"/ml-legacy-migration/swapna-automation-latest/sl_project","path_snode":"68e41304c35183d6068d7f62"}