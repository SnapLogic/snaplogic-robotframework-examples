<h1>Robot Tests Execution Flow</h1>

                <p>This document describes the execution flow for SnapLogic Robot Framework tests based on the
                    <code>PROJECT_SPACE_SETUP</code> parameter.
                </p>

                <div class="toc">
                    <h3>Table of Contents</h3>
                    <ul>
                        <li><a href="#robottests-overview">Overview</a></li>
                        <li><a href="#robottests-setup-mode">Setup Mode: PROJECT_SPACE_SETUP=True</a>
                            <ul style="margin-left: 20px; list-style: circle;">
                                <li><a href="#robottests-setup-flow">Detailed Execution Flow</a></li>
                            </ul>
                        </li>
                        <li><a href="#robottests-verify-mode">Verify Mode: PROJECT_SPACE_SETUP=False</a>
                            <ul style="margin-left: 20px; list-style: circle;">
                                <li><a href="#robottests-verify-flow">Detailed Execution Flow</a></li>
                            </ul>
                        </li>
                        <li><a href="#robottests-decision-guide">Decision Guide</a></li>
                        <li><a href="#robottests-error-scenarios">Common Error Scenarios</a></li>
                        <li><a href="#robottests-logging">Logging and Output</a></li>
                        <li><a href="#robottests-tips">Tips and Best Practices</a></li>
                        <li><a href="#rt-comparison">Comparison Table</a></li>
                        <li><a href="#rt-troubleshooting">Troubleshooting</a>
                            <ul style="margin-left: 20px; list-style: circle;">
                                <li><a href="#rt-scenarios">Common Scenarios and Solutions</a></li>
                                <li><a href="#rt-debug">Debug Commands</a></li>
                            </ul>
                        </li>
                        <li><a href="#rt-explore">📚 Explore More Documentation</a></li>
                    </ul>
                </div>

                <h2 id="robottests-overview">Overview</h2>
                <p>The <code>make robot-run-all-tests</code> command supports two modes of operation:</p>
                <ul>
                    <li><strong>Setup Mode</strong> (<code>PROJECT_SPACE_SETUP=True</code>): Creates/recreates project
                        space and Snaplex</li>
                    <li><strong>Verify Mode</strong> (<code>PROJECT_SPACE_SETUP=False</code>): Verifies existing project
                        space and runs tests</li>
                </ul>

                <hr>

                <h2 id="robottests-setup-mode">Setup Mode: PROJECT_SPACE_SETUP=True</h2>
                <p>When <code>PROJECT_SPACE_SETUP=True</code>, the system performs a complete setup of the SnapLogic
                    environment before running tests.</p>

                <p><strong>Usage:</strong></p>
                <pre>make robot-run-all-tests TAGS="oracle" PROJECT_SPACE_SETUP=True</pre>

                <h3 id="robottests-setup-flow">Detailed Execution Flow</h3>

                <pre style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; line-height: 1.6;">
PROJECT_SPACE_SETUP=True
│
├─ 🏗️ Phase 1: Create Project Space & Plex
│   │
│   ├─ 🚀 Initialize Robot Framework
│   │   ├─ Load .env configuration
│   │   ├─ Set up global variables
│   │   └─ Prepare test environment
│   │
│   ├─ 🔄 Run createplex Tests
│   │   │
│   │   ├─ 📋 SCENARIO A: Clean Setup (No Conflicts)
│   │   │   ├─ 🗑️ Delete existing project space (if exists)
│   │   │   ├─ ✨ Create new project space 'sl-automation-ps'
│   │   │   ├─ 📁 Create project 'sl_project'
│   │   │   ├─ 🔧 Create Snaplex in project
│   │   │   ├─ 📦 Download Snaplex configuration
│   │   │   └─ ✅ Setup completed successfully
│   │   │
│   │   └─ ⚠️ SCENARIO B: Active Groundplex Nodes Detected
│   │       │
│   │       ├─ ❌ Initial delete attempt fails
│   │       │   └─ Error: "cannot be deleted while it contains active nodes"
│   │       │
│   │       ├─ 🔍 Intelligent Error Detection
│   │       │   ├─ Parse error logs
│   │       │   └─ Identify active nodes issue
│   │       │
│   │       ├─ 🔄 Automatic Recovery Process:
│   │       │   ├─ 🛑 Stop Groundplex container
│   │       │   ├─ ⏳ Wait 60 seconds for node deregistration
│   │       │   └─ 🔁 Retry createplex tests
│   │       │
│   │       └─ ✅ Recovery Success:
│   │           ├─ 🗑️ Delete project space
│   │           ├─ ✨ Create new project space
│   │           └─ 📦 Complete setup
│
├─ 🚀 Phase 2: Launch Groundplex
│   ├─ 🔄 Start Groundplex container
│   ├─ 🔍 Health checks (up to 20 attempts)
│   └─ ✅ Groundplex ready
│
└─ 🧪 Phase 3: Run Tagged Tests
    ├─ 🏷️ Filter tests by TAGS parameter
    ├─ 🔄 Execute matching test suites
    └─ 📊 Generate test reports</pre>

                <hr>

                <h2 id="robottests-verify-mode">Verify Mode: PROJECT_SPACE_SETUP=False</h2>
                <p>When <code>PROJECT_SPACE_SETUP=False</code> (default), the system verifies existing infrastructure
                    before running tests.</p>

                <p><strong>Usage:</strong></p>
                <pre>make robot-run-all-tests TAGS="postgres_s3"  # Default is False</pre>

                <h3 id="robottests-verify-flow">Detailed Execution Flow</h3>

                <pre style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; line-height: 1.6;">
PROJECT_SPACE_SETUP=False (or not set)
│
├─ 🔍 Phase 1: Verify Project Space
│   ├─ 🚀 Initialize Robot Framework
│   │   ├─ Load .env configuration
│   │   └─ Set up global variables
│   │
│   ├─ 📋 Check if project space exists
│   │
│   ├─ ✅ SCENARIO A: Project Space Exists
│   │   ├─ Log: "Project space 'sl-automation-ps' already exists"
│   │   └─ Continue to test execution
│   │
│   └─ ❌ SCENARIO B: Project Space Not Found
│       ├─ ⚠️ Display error message
│       │   └─ "ERROR: Project space 'sl-automation-ps' does not exist!"
│       ├─ 📝 Suggest solution:
│       │   └─ "Please run: make robot-run-all-tests TAGS=\"...\" PROJECT_SPACE_SETUP=True"
│       └─ 🛑 Exit with error code 1
│
└─ 🧪 Phase 2: Run Tagged Tests (if verification passes)
    ├─ 🏷️ Filter tests by TAGS parameter
    ├─ 🔄 Execute matching test suites
    └─ 📊 Generate test reports</pre>

                <hr>

                <h2 id="robottests-decision-guide">Decision Guide</h2>

                <h3>When to Use Each Mode</h3>

                <table border="1" style="border-collapse: collapse; margin: 15px 0; width: 100%;">
                    <tr>
                        <th style="padding: 10px; background: #667eea; color: white;">Scenario</th>
                        <th style="padding: 10px; background: #667eea; color: white;">Use This Mode</th>
                        <th style="padding: 10px; background: #667eea; color: white;">Command</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">First time running tests</td>
                        <td style="padding: 10px;"><code>PROJECT_SPACE_SETUP=True</code></td>
                        <td style="padding: 10px;">
                            <code>make robot-run-all-tests TAGS="oracle" PROJECT_SPACE_SETUP=True</code>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Project space already exists</td>
                        <td style="padding: 10px;"><code>PROJECT_SPACE_SETUP=False</code></td>
                        <td style="padding: 10px;"><code>make robot-run-all-tests TAGS="postgres_s3"</code></td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">After system restart</td>
                        <td style="padding: 10px;"><code>PROJECT_SPACE_SETUP=False</code></td>
                        <td style="padding: 10px;"><code>make robot-run-all-tests TAGS="mysql"</code></td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Need fresh environment</td>
                        <td style="padding: 10px;"><code>PROJECT_SPACE_SETUP=True</code></td>
                        <td style="padding: 10px;">
                            <code>make robot-run-all-tests TAGS="all" PROJECT_SPACE_SETUP=True</code>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">CI/CD pipeline</td>
                        <td style="padding: 10px;"><code>PROJECT_SPACE_SETUP=True</code></td>
                        <td style="padding: 10px;">
                            <code>make robot-run-all-tests TAGS="smoke" PROJECT_SPACE_SETUP=True</code>
                        </td>
                    </tr>
                </table>

                <hr>

                <h2 id="robottests-error-scenarios">Common Error Scenarios</h2>

                <h3>1. Active Groundplex Nodes</h3>
                <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 15px 0;">
                    <p><strong>⚠️ Error:</strong> "project space cannot be deleted while it contains active nodes"</p>
                    <p><strong>✅ Solution:</strong> The system automatically handles this by:</p>
                    <ul>
                        <li>Stopping the Groundplex container</li>
                        <li>Waiting for nodes to deregister</li>
                        <li>Retrying the deletion</li>
                    </ul>
                </div>

                <h3>2. Project Space Not Found</h3>
                <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 15px; margin: 15px 0;">
                    <p><strong>❌ Error:</strong> "Project space 'sl-automation-ps' does not exist!"</p>
                    <p><strong>✅ Solution:</strong> Run with <code>PROJECT_SPACE_SETUP=True</code>:</p>
                    <pre>make robot-run-all-tests TAGS="your_tags" PROJECT_SPACE_SETUP=True</pre>
                </div>

                <h3>3. Groundplex Connection Issues</h3>
                <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 15px; margin: 15px 0;">
                    <p><strong>❌ Error:</strong> "Groundplex health check failed"</p>
                    <p><strong>✅ Solution:</strong> Check:</p>
                    <ul>
                        <li>Network connectivity</li>
                        <li>.env file configuration</li>
                        <li>Docker container status</li>
                    </ul>
                </div>

                <hr>

                <h2 id="robottests-logging">Logging and Output</h2>

                <h3>Console Output Examples</h3>

                <h4>Setup Mode Output:</h4>
                <pre style="background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 8px;">
==============================================
Running with PROJECT_SPACE_SETUP=True
Creating/recreating project space and Snaplex...
==============================================

🏗️  Running createplex tests...
✅ Project space created: sl-automation-ps
✅ Project created: sl_project
✅ Snaplex created successfully

🚀 Launching Groundplex...
⏳ Waiting for Groundplex to be ready...
✅ Groundplex is ready!

🧪 Running tests with tags: oracle
...</pre>

                <h4>Verify Mode Output:</h4>
                <pre style="background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 8px;">
==============================================
Running with PROJECT_SPACE_SETUP=False
Verifying existing project space...
==============================================

✅ Project space 'sl-automation-ps' already exists
🧪 Running tests with tags: postgres_s3
...</pre>

                <hr>

                <h2 id="robottests-tips">Tips and Best Practices</h2>

                <h3>Performance Optimization</h3>
                <ul>
                    <li>🚀 Use <code>PROJECT_SPACE_SETUP=False</code> for faster test runs when infrastructure exists
                    </li>
                    <li>⚡ Run specific test tags instead of all tests</li>
                    <li>🔄 Reuse existing Groundplex when possible</li>
                </ul>

                <h3>Development Workflow</h3>
                <ol>
                    <li><strong>Initial Setup:</strong> Run with <code>PROJECT_SPACE_SETUP=True</code> once</li>
                    <li><strong>Development:</strong> Use <code>PROJECT_SPACE_SETUP=False</code> for quick iterations
                    </li>
                    <li><strong>Clean Run:</strong> Periodically run with <code>PROJECT_SPACE_SETUP=True</code> for
                        fresh environment</li>
                </ol>

                <h3>CI/CD Best Practices</h3>
                <ul>
                    <li>Always use <code>PROJECT_SPACE_SETUP=True</code> in CI/CD for reproducibility</li>
                    <li>Include cleanup steps in pipeline</li>
                    <li>Monitor for orphaned resources</li>
                </ul>

                <h3>Troubleshooting Commands</h3>
                <pre># Check Docker containers
docker ps -a | grep groundplex

# View logs
make groundplex-logs

# Manual cleanup
make stop-groundplex
make snaplogic-stop

# Fresh start
make clean-start</pre>

                <hr>

                <p><em>Remember: The choice between setup modes depends on your current environment state and testing
                        needs. When in doubt, use <code>PROJECT_SPACE_SETUP=True</code> for a clean, reproducible test
                        environment.</em></p>

                <hr>


                <h3 id="rt-setup-features">Key Features of Setup Mode</h3>

                <table>
                    <tr>
                        <th>Feature</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><strong>Clean Slate</strong></td>
                        <td>Always starts with fresh project space</td>
                    </tr>
                    <tr>
                        <td><strong>Intelligent Recovery</strong></td>
                        <td>Automatically handles active node conflicts</td>
                    </tr>
                    <tr>
                        <td><strong>Complete Setup</strong></td>
                        <td>Creates all necessary SnapLogic components</td>
                    </tr>
                    <tr>
                        <td><strong>Error Resilience</strong></td>
                        <td>Retries on known failure scenarios</td>
                    </tr>
                    <tr>
                        <td><strong>Automated Workflow</strong></td>
                        <td>No manual intervention required</td>
                    </tr>
                </table>

                <h3 id="rt-setup-when">When to Use Setup Mode</h3>

                <ul>
                    <li>✅ <strong>First-time setup</strong> of the testing environment</li>
                    <li>✅ <strong>Clean environment needed</strong> for critical tests</li>
                    <li>✅ <strong>Project space corrupted</strong> or in unknown state</li>
                    <li>✅ <strong>Snaplex configuration changed</strong> in .env file</li>
                    <li>✅ <strong>CI/CD pipelines</strong> requiring fresh environment</li>
                </ul>

                <hr>


                <h3 id="rt-verify-features">Key Features of Verify Mode</h3>

                <table>
                    <tr>
                        <th>Feature</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><strong>Fast Execution</strong></td>
                        <td>Skips setup, goes straight to testing</td>
                    </tr>
                    <tr>
                        <td><strong>Safety Checks</strong></td>
                        <td>Verifies prerequisites before running tests</td>
                    </tr>
                    <tr>
                        <td><strong>Read-Only Setup</strong></td>
                        <td>No modifications to SnapLogic cloud environment</td>
                    </tr>
                    <tr>
                        <td><strong>Fail-Fast</strong></td>
                        <td>Stops immediately if project space missing</td>
                    </tr>
                    <tr>
                        <td><strong>Clear Guidance</strong></td>
                        <td>Provides exact commands to fix issues</td>
                    </tr>
                </table>

                <h3 id="rt-verify-when">When to Use Verify Mode</h3>

                <ul>
                    <li>✅ <strong>Subsequent test runs</strong> after initial setup</li>
                    <li>✅ <strong>Quick test iterations</strong> during development</li>
                    <li>✅ <strong>Stable environment</strong> already configured</li>
                    <li>✅ <strong>Production testing</strong> where setup shouldn't change</li>
                    <li>✅ <strong>Debugging existing tests</strong> without environment changes</li>
                </ul>

                <hr>

                <h2 id="rt-usage">Usage Examples</h2>

                <h3 id="rt-basic">Basic Test Execution</h3>

                <pre># First time setup - create everything fresh
make robot-run-all-tests TAGS="oracle" PROJECT_SPACE_SETUP=True

# Subsequent runs - use existing setup
make robot-run-all-tests TAGS="oracle"

# Multiple tags
make robot-run-all-tests TAGS="oracle minio" PROJECT_SPACE_SETUP=True

# Explicitly set to False (same as default)
make robot-run-all-tests TAGS="postgres" PROJECT_SPACE_SETUP=False</pre>

                <h3 id="rt-cicd">CI/CD Pipeline Usage</h3>

                <pre># CI/CD typically needs fresh environment
make robot-run-all-tests TAGS="smoke" PROJECT_SPACE_SETUP=True

# Development environment with stable setup
make robot-run-all-tests TAGS="integration"</pre>

                <hr>

                <h2 id="rt-comparison">Comparison Table</h2>

                <table>
                    <tr>
                        <th>Aspect</th>
                        <th>Setup Mode (True)</th>
                        <th>Verify Mode (False)</th>
                    </tr>
                    <tr>
                        <td><strong>Phase 1 Action</strong></td>
                        <td>Delete/Create/Setup project space & plex</td>
                        <td>Verify existence only</td>
                    </tr>
                    <tr>
                        <td><strong>Error Handling</strong></td>
                        <td>Intelligent recovery for active nodes</td>
                        <td>Fail with clear instructions</td>
                    </tr>
                    <tr>
                        <td><strong>Groundplex</strong></td>
                        <td>Always launches fresh</td>
                        <td>Launches if verification passes</td>
                    </tr>
                    <tr>
                        <td><strong>Phase 3 Extra</strong></td>
                        <td>Direct test execution</td>
                        <td>Additional project verification</td>
                    </tr>
                    <tr>
                        <td><strong>Cloud Modifications</strong></td>
                        <td>Yes - creates/modifies resources</td>
                        <td>No - read-only checks</td>
                    </tr>
                    <tr>
                        <td><strong>Use Case</strong></td>
                        <td>Fresh setup/CI/CD/clean environment</td>
                        <td>Development/debugging/stable env</td>
                    </tr>
                    <tr>
                        <td><strong>Execution Time</strong></td>
                        <td>Longer (3-5 minutes)</td>
                        <td>Faster (1-2 minutes)</td>
                    </tr>
                    <tr>
                        <td><strong>Prerequisites</strong></td>
                        <td>Valid .env configuration</td>
                        <td>Existing project space & project</td>
                    </tr>
                    <tr>
                        <td><strong>Risk Level</strong></td>
                        <td>Higher - modifies cloud resources</td>
                        <td>Lower - read-only operations</td>
                    </tr>
                </table>

                <hr>

                <h2 id="rt-troubleshooting">Troubleshooting</h2>

                <h3 id="rt-scenarios">Common Scenarios and Solutions</h3>

                <table>
                    <tr>
                        <th>Scenario</th>
                        <th>Error Message</th>
                        <th>Solution</th>
                    </tr>
                    <tr>
                        <td><strong>Active Nodes</strong></td>
                        <td>"cannot be deleted while it contains active nodes"</td>
                        <td>Automatically handled in Setup Mode</td>
                    </tr>
                    <tr>
                        <td><strong>Missing Project Space</strong></td>
                        <td>"Project space 'sl-automation-ps' is not created"</td>
                        <td>Run with <code>PROJECT_SPACE_SETUP=True</code></td>
                    </tr>
                    <tr>
                        <td><strong>JCC Failed to Start</strong></td>
                        <td>"JCC failed to start after 20 attempts"</td>
                        <td>Check Groundplex logs, restart Docker</td>
                    </tr>
                    <tr>
                        <td><strong>Invalid Credentials</strong></td>
                        <td>"401 Unauthorized"</td>
                        <td>Verify .env file credentials</td>
                    </tr>
                    <tr>
                        <td><strong>Network Issues</strong></td>
                        <td>"Connection timeout"</td>
                        <td>Check network connectivity, proxy settings</td>
                    </tr>
                </table>

                <h3 id="rt-debug">Debug Commands</h3>

                <pre># Check Groundplex status
make groundplex-status

# View Groundplex logs
docker logs snaplogic-groundplex

# Restart Groundplex
make restart-groundplex

# Clean start everything
make clean-start</pre>

                <hr>

                <h2 id="rt-explore">📚 Explore More Documentation</h2>
                <p>💡 <strong>Need help finding other guides?</strong> Check out our <strong><a
                            href="../../reference.md">📖 Complete Documentation Reference</a></strong> for a
                    comprehensive overview of all available tutorials, how-to guides, and quick start paths. It's your
                    one-stop navigation hub for the entire SnapLogic Test Framework documentation!</p>